{% extends 'base.html' %}
{%load static%}
{%block content%}
<h1>Pedido {{ pedido.id }}</h1>

<div class="container-pai">
    <div class="bloco">
        <h3>ğŸ‘¤ Cliente</h3>
        <p><strong>Nome:</strong> {{ pedido.cliente|default:"NÃ£o informado" }}</p>
        <p><strong>Celular:</strong> {{ pedido.celular|default:"NÃ£o informado" }}</p>
    </div>
            
    <div class="bloco">
    <h3>ğŸ’° Pagamento</h3>
        <p><strong>Forma:</strong> {{ pedido.forma_pagamento }}</p>
        <p><strong>Valor Total:</strong> R$ {{ pedido.valor_total|floatformat:2 }}</p>
    </div>

    <div class="bloco">
        <h3>ğŸšš Entrega</h3>
        <p><strong>Data/Hora:</strong> 
        {% if pedido.data_hora_entrega %}
            {{ pedido.data_hora_entrega|date:"d/m/Y H:i" }}
        {% else %}
            NÃ£o agendada
        {% endif %}
        </p>
        <div class="status-indicator">
            <span class="status-dot 
            {% if pedido.data_hora_entrega and pedido.data_hora_entrega < now %}entregue
            {% elif pedido.data_hora_entrega %}pendente
            {% else %}cancelado{% endif %}">
            </span>
            <span>
                {% if pedido.data_hora_entrega and pedido.data_hora_entrega < now %}
                    <strong>Status: </strong>Entregue
                {% elif pedido.data_hora_entrega %}
                    <strong>Status: </strong>Pendente
                {% else %}
                    <strong>Status: </strong>Sem entrega
                {% endif %}
            </span>
        </div>
    </div>  

    <div class="bloco">
                <h3>ğŸ“Š InformaÃ§Ãµes</h3>
                <p><strong>ID:</strong> {{ pedido.id }}</p>
                <p><strong>CriaÃ§Ã£o:</strong> {{ pedido.data_hora|date:"d/m/Y H:i" }}</p>
                <p><strong>Itens:</strong> {{ itens.count }}</p>
    </div>
</div>      
        
<h2>ğŸ›’ Itens do Pedido</h2>
        {% if itens %}
            <table class="table">
                <thead>
                    <tr>
                        <th>Produto</th>
                        <th>Quantidade</th>
                        <th>PreÃ§o UnitÃ¡rio</th>
                        <th class="text-right">Subtotal</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in itens %}
                    <tr>
                        <td>{{ item.produto.nome_produto }}</td>
                        <td>{{ item.quantidade|floatformat:2 }}</td>
                        <td>R$ {{ item.produto.preco_unitario|floatformat:2 }}</td>
                        <td class="text-right">R$ {{ item.subtotal|floatformat:2 }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td colspan="3"><strong>Total do Pedido</strong></td>
                        <td class="text-right"><strong>R$ {{ pedido.valor_total|floatformat:2 }}</strong></td>
                    </tr>
                </tfoot>
            </table>
        {% else %}
            <div class="empty-state">
                <div>ğŸ“­</div>
                <h3>Nenhum item neste pedido</h3>
                <p>Este pedido nÃ£o contÃ©m itens.</p>
            </div>
        {% endif %}
        
        <a href="{% url 'pedidos:editar' pedido.id %}" class="btn btn-warning">âœï¸ Editar Pedido</a>
        <a href="{% url 'pedidos:listar' %}" class="btn btn-secondary">â† Voltar para Lista</a>
        <a href="{% url 'pedidos:deletar' pedido.id %}" class="btn btn-danger">ğŸ—‘ï¸ Excluir Pedido</a>
        <button onclick="window.print()" class="btn btn-primary no-print">ğŸ–¨ï¸ Imprimir</button>
    </div>
{%endblock%}