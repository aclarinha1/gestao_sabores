{% extends 'base.html' %}
{%load static%}
{%block content%}

<h1>‚úèÔ∏èEditar Categoria: {{ form.instance.nome_categoria }}</h1>
{% if form.instance.produtos.count > 0 %}
            <div class="warning-note">
                ‚ö†Ô∏è <strong>Aten√ß√£o:</strong> Esta categoria cont√©m {{ form.instance.produtos.count }} produto(s). 
                A altera√ß√£o do nome afetar√° todos os produtos vinculados.
            </div>
        {% endif %}
    <div class="form-container">
            <form method="post">
                {% csrf_token %}
                
                <div class="form-group">
                    <label for="id_nome_categoria"><strong>Nome da Categoria:</strong></label>
                    {{ form.nome_categoria }}
                </div>
                
                <div class="form-group">
                    <label for="id_descricao"><strong>Descri√ß√£o:</strong></label>
                    {{ form.descricao }}
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">üíæ Atualizar Categoria</button>
                    <a href="{% url 'categoria:detalhar' form.instance.pk %}" class="btn btn-secondary">‚Ü©Ô∏è Cancelar</a>
                    <a href="{% url 'categoria:deletar' form.instance.pk %}" class="btn btn-danger">üóëÔ∏è Excluir</a>
                </div>
            </form>
            
            {% if form.instance.produtos.count > 0 %}
                <div style="margin-top: 30px;">
                    <h3>üì¶ Produtos Vinculados ({{ form.instance.produtos.count }}):</h3>
                    <ul>
                        {% for produto in form.instance.produtos.all|slice:":5" %}
                            <li>
                                <a href="{% url 'produtos:detalhar' produto.pk %}">{{ produto.nome_produto }}</a> - R$ {{ produto.preco_unitario }}
                            </li>
                        {% endfor %}
                        {% if form.instance.produtos.count > 5 %}
                            <li><em>... e mais {{ form.instance.produtos.count|add:"-5" }} produtos</em></li>
                        {% endif %}
                    </ul>
                </div>
            {% endif %}
    </div>

{%endblock%}
